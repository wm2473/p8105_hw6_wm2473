---
title: "p8105_hw6_wm2473"
output: github_document
date: "2022-11-26"
---

```{r}
library(tidyverse)
library(readxl)
```

```{r}
hd = read_csv("homicide-data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(city_state = str_c(city,",", state), 
         homicides = case_when(disposition == "Closed without arrest" ~ "unsolved homicides", disposition == "Open/No arrest" ~ "unsolved homicides", disposition == "Closed by arrest" ~ "solved homicides")) %>% 
    filter(!city_state %in% c("Tulsa,AL","Dallas,TX", "Phoenix,AZ", "Kansas City,MO"),victim_race %in% c("Black","White"), victim_age == as.numeric(victim_age))
```


```{r}
md = hd %>% 
  filter(city_state %in% "Baltimore,MD") %>% 
  mutate(victim_age = as.numeric(victim_age), victim_race = as.factor(victim_race), victim_sex = as.factor(victim_sex), homicides = ifelse(
           disposition %in% c("Closed without arrest", "Open/No arrest"), 0, 1))

fit_1 = glm(homicides ~ victim_age+ victim_sex+ victim_race, data =md, family= binomial()) 
    
tidy = fit_1 %>% 
  broom::tidy() %>% 
  filter(term == "victim_sexMale") %>% 
  mutate(OR = exp(estimate), lower = exp(estimate - 1.96 * std.error),
    upper = exp(estimate + 1.96 * std.error)) %>% 
select(term, OR, lower, upper)
```

